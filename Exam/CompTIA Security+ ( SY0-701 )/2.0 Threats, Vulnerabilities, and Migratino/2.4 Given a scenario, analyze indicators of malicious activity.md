
```txt
The preparation phase of incident response identifies data sources that
can support investigations. It also provisions tools to aggregate and
correlate this data and partially automate its analysis to drive an 
alerting and monitoring system. While automated detection is a huge 
support for the security team, it cannot identify all indicators of 
malicious activity. As an incident responder, you must be able to 
identify signs in data sources that point to a particular type of attack.
```

## Malware Classification

**Summary**

- **Malware:** Software designed to perform malicious actions on a system or network.
- **Malware Vectors:** The methods by which malware is delivered and executed on a system.
- **Types of Malware (Based on Vector):**
    - **Viruses:** Spread by infecting legitimate executable files.
    - **Worms:** Self-replicating malware that spreads independently, often over networks.
    - **Trojans:** Disguised as legitimate software, installed without user consent.
    - **Potentially Unwanted Programs (PUPs)/Potentially Unwanted Applications (PUAs):** Software installed alongside desired programs, often without explicit consent. Also known as grayware or bloatware.
- **Payload Classifications:**
    - **Spyware:** Gathers information about a user or organization without their knowledge.
    - **Rootkit:** Designed to hide its presence and maintain administrator-level access to a system.
    - **Remote Access Trojan (RAT):** Provides unauthorized remote access to a compromised system.
    - **Ransomware:** Encrypts files and demands a ransom for decryption.

![](../../../Attachments/Pasted%20image%2020240805000151.png)
## Computer Viruses

**Summarry**

A computer virus is a type of malware designed to replicate and spread by infecting executable applications or program code. There are several types of viruses based on the files or media they infect:

- **Non-resident/File Infector:** The virus is in a host executable file and infects other processes when the host runs.
- **Memory Resident:** The virus creates a process in memory when the host file is executed, staying active even if the host is terminated.
- **Boot:** The virus infects the disk boot sector or partition table and becomes active when the OS starts.
- **Script and Macro Viruses:** These use local scripting engines, such as PowerShell or JavaScript, or embedded code in documents like VBA in Microsoft Office files.
- **Multipartite:** These use multiple infection vectors.
- **Polymorphic:** These viruses change or obfuscate their code to evade detection.

All these viruses need a host file or media to spread, which can be distributed via disks, networks, email attachments, social media, or website downloads.

![](../../../Attachments/Pasted%20image%2020240805000828.png)

## Computer Worms and Filesless Malware

**Summary**

- **Worms vs. Viruses:**
    - Worms are self-replicating malware that spread independently over networks.
    - Viruses require user action (e.g., opening a file) to execute and spread.
- **Impact:**
    - Worms primarily consume network bandwidth, slowing down networks.
    - They can also cause system crashes (denial of service attacks) and carry malicious payloads.
- **Fileless Malware:**
    - Doesn't store its code on disk, making it harder to detect.
    - Often uses memory-resident techniques and legitimate system tools (like PowerShell and WMI) to operate.
    - Relies on obfuscation and on-the-fly compilation to evade detection.
- **Terminology:**
    - APT (Advanced Persistent Threat) and AVT (Advanced Volatile Threat) are types of modern fileless malware.
    - LOC (Low-Observable Characteristics) attacks are another term for this type of threat.

**Key Concepts & Definitions:**

- **Computer Worm:** Self-replicating malware that can spread across networks without user intervention.
- **Virus:** Malware that requires user action to execute and spread.
- **Payload:** The malicious code carried by a worm or virus to perform harmful actions.
- **Denial of Service (DoS) Attack:** An attack that disrupts or crashes a system or network.
- **Fileless Malware:** Malware that doesn't store its code on disk, making it harder to detect.
- **Shellcode:** Small, self-contained code used by malware to establish a backdoor on a host.
- **Obfuscation:** The act of making code difficult to understand to evade detection.
- **Live off the Land:** A technique where malware uses legitimate system tools for malicious purposes.
- **PowerShell:** A powerful scripting language and command-line shell built into Windows.
- **WMI (Windows Management Instrumentation):** A set of tools for managing Windows systems.
- **APT (Advanced Persistent Threat):** A stealthy threat actor that maintains long-term access to a system.
- **AVT (Advanced Volatile Threat):** A threat actor that quickly exploits vulnerabilities for immediate gain.
- **LOC (Low-Observable Characteristics) Attack:** A stealthy attack designed to evade detection.

## Spyware and Keyloggers

 **Summary:**

- **Malware Evolution:**
    - Early viruses and worms focused on replication and destruction.
    - Modern malware increasingly targets user data for profit through intrusion, fraud, and theft.
- **Bloatware and Monitoring:**
    - Bloatware and malware employ various techniques to monitor users and collect data.
- **Tracking Cookies:**
    - Plaintext files that record web activity and collect user data when allowed by browser settings.
- **Supercookies and Beacons:**
    - Stealthy tracking mechanisms that are harder to detect and disable. Supercookies store tracking data in unconventional ways, while beacons use tiny images to track users.
- **Adware:**
    - A type of bloatware that modifies browser settings to enable tracking, display ads, and promote specific websites.
- **Spyware:**
    - Malware that tracks user activity, captures screenshots, records audio/video, and may redirect to malicious sites.
- **Keyloggers:**
    - Spyware designed to record keystrokes to steal sensitive information like passwords and credit card details.
    - Keyloggers can be implemented as software, hardware devices, or scripts.
- **Metasploit Meterpreter:**
    - A powerful remote access tool that can be used to capture keystrokes and other sensitive data.

![](../../../Attachments/Pasted%20image%2020240805001547.png)

 **Key Concepts & Definitions:**

- **Tracking Cookie:** A plaintext file used to track user activity and collect data.
- **Supercookie:** A tracking mechanism that stores data in unconventional ways, making it harder to detect and disable.
- **Beacon:** A tiny image embedded in a website that allows tracking and data collection.
- **Adware:** Bloatware that modifies browser settings to display ads and track user activity.
- **Spyware:** Malware that covertly monitors user activity and collects data.
- **Keylogger:** Spyware designed to record keystrokes to steal sensitive information.
- **Metasploit Meterpreter:** A remote access tool used for various malicious activities, including keylogging.

## Backdoors and Remote Access Trojans

**Summary:**

- **Backdoors:**
    - Any unauthorized access method that bypasses normal authentication and grants administrative control.
    - Can be used for various malicious activities, including data exfiltration, system manipulation, and malware installation.
- **Remote Access Trojans (RATs):**
    - Backdoor malware disguised as legitimate remote control programs.
    - Enable attackers to remotely control a compromised host (zombie) and perform malicious actions.
- **Bots and Botnets:**
    - Bots are automated scripts or tools used to carry out malicious tasks.
    - A botnet is a group of compromised hosts controlled by a central malware instance.
    - Botnets can be used for DDoS attacks, spam campaigns, and cryptomining.
- **Command and Control (C2/C&C):**
    - The communication channel used by attackers to control compromised hosts and botnets.
    - Often hidden within legitimate traffic to evade detection.
- **Other Backdoors:**
    - Backdoors can also be created unintentionally through programming errors or misconfigurations.

![](../../../Attachments/Pasted%20image%2020240805001815.png)

**Key Concepts & Definitions:**

- **Backdoor:** An unauthorized access method bypassing normal authentication.
- **Remote Access Trojan (RAT):** Malware that allows remote control of a compromised host.
- **Zombie:** A compromised host under malicious control.
- **Bot:** An automated script or tool used for malicious purposes.
- **Botnet:** A group of compromised hosts controlled by a central malware instance.
- **Command and Control (C2/C&C):** The communication channel used to control compromised hosts.
- **Covert Channel:** A hidden communication channel used to evade detection.
- **Internet Relay Chat (IRC):** A protocol historically used for C2 communication.
## Rootkits

**Summary:**

- **Malware and User Privileges:**
    - Malware inherits the privileges of the user who executes it.
    - Standard user permissions limit malware actions to user-specific files and settings.
    - Local administrator privileges allow broader system modifications.
- **User Account Control (UAC):**
    - A Windows security feature that prompts users for confirmation before allowing actions that require administrative privileges.
    - Helps mitigate the risk of unintended malware installations or privilege escalation.
- **Privilege Escalation:**
    - Malware may attempt to gain elevated privileges, such as SYSTEM level access, to bypass security controls and gain greater control over the system.
- **Rootkits:**
    - Malware running with SYSTEM level privileges, giving them unrestricted access to the system.
    - Can manipulate system files, hide processes, and evade detection by traditional security tools.
    - Rootkits can reside in various levels of the system, including kernel space and even firmware.

**Key Concepts & Definitions:**

- **User Privileges:** The level of access and control a user has over a system.
- **Standard User:** A user with limited privileges to protect the system from unauthorized changes.
- **Local Administrator:** A user with elevated privileges to install software and modify system settings.
- **User Account Control (UAC):** A Windows security feature that prompts users for confirmation before allowing actions that require administrative privileges.
- **Privilege Escalation:** The act of gaining higher-level privileges on a system.
- **SYSTEM Privileges:** The highest level of privilege in Windows, typically reserved for critical system processes.
- **Rootkit:** Malware running with SYSTEM privileges, allowing deep system-level access and control.
- **Kernel Space:** The core of the operating system where critical processes run with high privileges.
- **Firmware:** Permanent software programmed into a read-only memory (ROM) chip that controls hardware devices.

## Ransomware, Crypto-Malware, and Logic Bombs

**Summary:**

- **Ransomware:**
    - Malware designed to extort money by denying access to a victim's computer or data.
    - Payment methods often used include wire transfer, cryptocurrency, or premium-rate phone lines.
- **Scareware:**
    - Malware that displays alarming messages to scare users into paying for unnecessary services or software.
- **Crypto-Ransomware:**
    - Encrypts data files, making them inaccessible without the decryption key, which the attacker holds for ransom.
- **Cryptojacking Malware:**
    - Maliciously uses a victim's computer resources to mine cryptocurrency without their knowledge or consent.
- **Logic Bombs:**
    - Malware or scripts that trigger upon a specific time or event, often used for sabotage or revenge.
- **Time Bomb:**
    - A logic bomb that activates at a preconfigured time.
- **Event Bomb:**
    - A logic bomb that activates based on a specific system or user event.
- **Mine:**
    - Another term for a logic bomb, often used to describe malicious scripts or programs left behind by disgruntled employees.

 **Key Concepts & Definitions:**

- **Ransomware:** Malware that demands payment to restore access to a victim's computer or data.
- **Scareware:** Malware that uses scare tactics to trick users into paying for unnecessary services or software.
- **Crypto-Ransomware:** Ransomware that encrypts data files and demands payment for the decryption key.
- **Cryptojacking Malware:** Malware that secretly uses a victim's computer resources to mine cryptocurrency.
- **Logic Bomb:** Malware or script that triggers upon a specific time or event.
- **Time Bomb:** A logic bomb that activates at a preconfigured time.
- **Event Bomb:** A logic bomb that activates based on a specific system or user event.
- **Mine:** A term often used to describe malicious scripts or programs left behind by disgruntled employees.

## TTPS AND IOCS

**Summary**

- **Traditional Antivirus (A-V) scanners:** Rely on signature-based detection, comparing files against a database of known malware code. While still useful for common threats, it's no longer sufficient due to the evolving nature of cyberattacks.
    
- **Modern Threat Detection:** Focuses on identifying malicious behavior patterns by analyzing TTPs (Tactics, Techniques, and Procedures).
    
- **Tactics:** Broad descriptions of attacker goals, like reconnaissance or privilege escalation.
    
- **Techniques:** The methods used to achieve those goals, such as vulnerability scanning or phishing.
    
- **Procedures:** Specific steps involved in executing a technique, often revealing attacker tools and methodologies.
    
- **Indicators of Compromise (IoCs):** Signs of a successful or ongoing attack. These are evidence of TTPs in action.
    
**The evolution of cyber threats has made signature-based antivirus insufficient. Modern threat detection emphasizes identifying malicious behavior by analyzing TTPs (Tactics, Techniques, and Procedures).** TTPs help understand the attacker's goals (Tactics), the methods they employ (Techniques), and the specific actions they take (Procedures). IoCs (Indicators of Compromise) serve as evidence of these TTPs, offering insights into past or ongoing attacks.

- **Variety of IoCs:** The multitude of attack targets and vectors results in a vast array of potential IoCs, from malware signatures to anomalous activity patterns.
    
- **Threat Intelligence and AI:** Resources like the MITRE ATT&CK database document known TTPs and IoCs, aiding in automated threat detection. AI-powered systems enhance the analysis and response capabilities of modern threat protection suites.
    
- **IoCs vs. IoAs:** While IoCs signify successful attacks, IoAs (Indicators of Attack) indicate potential intrusion attempts.
    

**The vast number of potential IoCs necessitates resources like the MITRE ATT&CK database, which documents known threats, and the utilization of AI for effective threat detection and response.** AI plays a crucial role in analyzing patterns of anomalous activity, enabling timely identification of potential intrusions. IoCs, indicating successful attacks, differ from IoAs (Indicators of Attack), which suggest attempts at intrusion.

## MALICIOUS ACTIVITY INDICATORS

Overall Summary:
This text focuses on recognizing various indicators of malware and malicious activity on a system. It covers behavioral signs like abnormal resource consumption, file system alterations, and account compromise, as well as investigative techniques like sandbox analysis.

Breaking down concepts and terms:

- **Malware:** Malicious software designed to disrupt, damage, or gain unauthorized access to a computer system.
- **Sandbox:** An isolated environment used to test and observe the behavior of potentially malicious code without affecting the production network.
- **Sheep dip:** A dedicated, isolated host used to scan and test new software and removable media for malware before allowing it into the production network.
- **Resource Consumption:** The use of system resources like CPU, memory, disk, and network bandwidth. Abnormal consumption can be an indicator of malware activity.
- **File System:** The structure on a storage device that organizes and stores files and data. Malicious code often interacts with the file system, leaving traces that can be detected.
- **Registry:** A hierarchical database that stores configuration settings and options for the operating system and installed applications. Malware might modify the registry to maintain persistence or evade detection.  
- **DLP (Data Loss Prevention):** A system that monitors and controls data movement to prevent unauthorized access, use, or transmission of sensitive information.
- **Account Compromise:** When a threat actor gains unauthorized access to a user's account.
- **Log Files:** Records of events and activities that occur within a system or application.

## PHYSICAL ATTACKS

This section focuses on physical attacks, specifically those targeting cabling, hardware, or the physical environment. It covers brute force attacks, environmental attacks, and RFID cloning/skimming.

Breaking down concepts and terms:

- Brute force physical attacks: This involves physically damaging hardware or breaking into secure areas to disrupt services or steal equipment.
- Environmental attacks: These target a facility's infrastructure, like power or cooling systems, to cause disruption or gain network access.
- RFID cloning and skimming: These attacks focus on duplicating or stealing data from contactless access cards. Cloning creates a physical copy of a card, while skimming captures card details using a counterfeit reader.
- NFC (Near-field communication): A close-range technology often used for contactless cards, enabling two-way communication between devices.

## NETWORK ATTACKS

Overall Summary: This section describes the different stages of a network attack, from initial reconnaissance to data exfiltration. Threat actors use various techniques to disrupt networks or gain unauthorized access. Understanding these stages helps in detecting and preventing such attacks.

Breaking down concepts and terms:

- Reconnaissance: The initial phase where attackers gather information about the target network, including active hosts, open ports, and software versions.
- Credential harvesting: Attackers attempt to obtain user passwords or other secrets to gain authenticated access.
- Denial of service (DoS): Attacks aimed at making network resources unavailable, often to facilitate other attacks.
- Weaponization, delivery, and breach: Techniques used to gain unauthorized access, typically involving malware or exploiting vulnerabilities.
- Command and control (C2): Mechanisms used by attackers to remotely control compromised systems and maintain access.
- Lateral movement and privilege escalation: Attackers move within the network and gain higher-level privileges to access more resources.
- Data exfiltration: The final stage where attackers steal sensitive data from the compromised network.

## DISTRIBUTED DENIAL OF SERVICE ATTACKS

Overall Summary: This section describes Denial of Service (DoS) attacks, which aim to disrupt the availability of a resource. It explains different types of DoS attacks, including DDoS, DRDoS, and amplification attacks, and highlights the challenges in mitigating them.

![](../../../Attachments/Pasted%20image%2020240818192431.png)

Breaking down concepts and terms:

- DoS attack: Any action that reduces or disrupts the availability of a resource.
- DDoS (Distributed Denial of Service): An attack launched from multiple sources simultaneously, often using a botnet.
- Botnet: A network of compromised computers controlled by an attacker.
- SYN flood: A DDoS attack exploiting the TCP three-way handshake to overwhelm a target's connection queue.
- DRDoS (Distributed Reflected DoS): An attack that spoofs the victim's IP address to generate responses from multiple third-party servers, overwhelming the victim's bandwidth.
- Amplification attack: A type of DRDoS that exploits specific protocols to generate disproportionately large responses, further amplifying the attack's impact.
- DDoS mitigation: Techniques to protect against DoS attacks, including high availability services and stateful firewalls.

## ON-PATH ATTACKS

This text explains on-path attacks, also known as man-in-the-middle (MITM) or adversary-in-the-middle (AitM) attacks. In this attack, the threat actor sits between two communicating hosts and can intercept, monitor, and even modify the data exchanged. The text also focuses on a specific example: ARP poisoning, a layer 2 attack that manipulates the MAC address resolution process, potentially leading to an on-path attack.

![](../../../Attachments/Pasted%20image%2020240818192718.png)

**Key Points:**

- On-path attacks involve a threat actor positioning themselves between two hosts, allowing them to control and manipulate the communication without detection.
- ARP poisoning is a specific type of on-path attack that exploits vulnerabilities in the ARP protocol to misdirect traffic.
- Ettercap is a tool commonly used for ARP poisoning.
- Gratuitous ARP replies, seen in packet captures, are a strong indicator of an ARP poisoning attack.
- A successful ARP poisoning attack can allow the attacker to intercept and control all traffic destined for remote networks.

## DOMAIN NAME SYSTEM ATTACKS

Overall Summary: This section covers the Domain Name System (DNS) and its vulnerabilities to various attacks. It emphasizes that DNS attacks can occur both on the public internet and private networks, with techniques ranging from typosquatting to DNS poisoning. The text also highlights the importance of DNS logs in identifying and mitigating such attacks.

Breaking Down Concepts and Terms:

- DNS (Domain Name System): A system that translates human-readable domain names into IP addresses, enabling users to access websites and other online resources.  
- DNS Attacks: Malicious attempts to exploit vulnerabilities in the DNS, disrupting its functionality or compromising user data.
- Typosquatting: A technique where attackers register domain names similar to legitimate ones, hoping to trick users into visiting malicious sites.
- DRDoS (Distributed Reflected Denial of Service): A type of DDoS attack that uses DNS to amplify the attack traffic and overwhelm the target.
- DNS Poisoning: An attack that aims to corrupt DNS records, redirecting users to malicious websites or disrupting network services.
- ARP Poisoning: A technique used to manipulate MAC address resolution, allowing attackers to intercept and redirect network traffic.
- DNS Cache Poisoning: An attack that targets DNS server caches, inserting false records to mislead users or disrupt services.
- DNS Logs: Records of DNS activity that can be used to identify suspicious patterns and detect attacks.
- C&C (Command and Control): Mechanisms used by attackers to control compromised systems remotely.
- Data Exfiltration: The unauthorized transfer of sensitive data from a network.

## WIRELESS ATTACKS

This section highlights the security challenges associated with wireless networks. It details threats like rogue access points (including evil twins), wireless denial of service attacks, and vulnerabilities in wireless authentication protocols like KRACK attacks.

Breaking Down Concepts and Terms:

- Rogue Access Points: Unauthorized access points set up on a network, potentially creating backdoors for attackers.
- Evil Twin: A rogue access point masquerading as a legitimate one, often using similar SSIDs or BSSIDs to deceive users.
- Wireless DoS (Denial of Service): Attacks disrupting wireless network availability, often by jamming or interfering with signals.
- Disassociation attack: A type of wireless DoS that exploits unencrypted management frames to disconnect clients from the network.
- Replay attack: An attack that captures and reuses authentication information, potentially leading to unauthorized access.
- KRACK attack: A specific replay attack targeting the WPA and WPA2 handshake process, regardless of the authentication type.

## PASSWORD ATTACKS

This text explores password attacks, which aim to exploit weaknesses in password selection and management to recover the plaintext password. It discusses both online and offline attack methods, along with techniques like brute force, dictionary, hybrid, and password spraying.

## Key Points

- **Online Attacks:** Attackers directly interact with the authentication system, trying different passwords or exploiting vulnerabilities.
- **Offline Attacks:** Attackers obtain a database of password hashes and try to crack them without directly interacting with the authentication system.
- **Brute Force Attacks:** Attackers systematically try every possible combination to crack the hash.
- **Dictionary and Hybrid Attacks:** Attackers use a pre-defined list of common passwords or combine them with brute force techniques.
- **Password Spraying:** Attackers try a few common passwords across a large number of usernames.

## CREDENTIAL REPLAY ATTACKS

This text discusses the methods used by threat actors to gain access to and exploit sensitive data within a network. It highlights the initial steps threat actors take to establish a foothold, move laterally through the network, and escalate privileges. The text emphasizes the significance of credential replay attacks, particularly in Windows Active Directory environments, and describes how these attacks can compromise cached credentials and facilitate unauthorized access to resources. It also touches on mitigation strategies, such as patching, secure configuration, and detection systems.

![](../../../Attachments/Pasted%20image%2020240818193640.png)

**Breaking down concepts and terms**:

- **Initial foothold**: The initial point of access a threat actor gains into a network, often through compromising a single workstation.
- **Lateral movement**: The process of moving from an initial compromised system to other systems within a network to expand access and control.
- **Privilege escalation**: The act of gaining higher-level permissions and access rights within a system or network.
- **Credential replay attacks**: Exploiting locally stored credentials to start authenticated sessions on other hosts and applications.
- **LSASS**: The Local Security Authority Subsystem Service, responsible for managing authentication and authorization on Windows systems.
- **NT hash**: A hashed representation of a user's password used for authentication.
- **Pass the hash (PtH)**: An attack that uses a captured NT hash to authenticate to a system without knowing the actual password.
- **Kerberos**: A network authentication protocol used in Windows Active Directory environments.
- **Golden ticket attack**: An attack that forges a Kerberos ticket granting ticket, granting unrestricted access to domain resources.
- **Silver ticket attack**: An attack that forges Kerberos service tickets to access specific resources.

## CRYPTOGRAPHIC ATTACKS

This text describes various cryptographic attacks aimed at weakening authentication systems. Downgrade attacks force the use of less secure protocols, while collision attacks exploit weaknesses in hashing functions to forge signatures. The birthday attack cleverly leverages probability to find collisions with less computational effort than expected. These attacks highlight the necessity of robust cryptographic implementations for secure authentication.

**Breaking down concepts and terms:**

- **Downgrade Attack:** Forces a system to use weaker cryptographic protocols or ciphers, making it easier to compromise.
- **Kerberoasting:** A type of downgrade attack that attempts to crack service account passwords by forcing the use of weaker encryption.
- **Collision Attack:** Exploits weaknesses in hash functions to generate two different inputs that produce the same hash, potentially leading to forged signatures.
- **Birthday Attack:** Leverages probability and brute force to find hash collisions faster than a full search would allow.
- **Birthday Paradox:** Demonstrates that the probability of two people in a group sharing the same birthday is higher than one might intuitively expect.
- **Hash Functions:** Algorithms that convert data into a fixed-length string of characters (hash), used for integrity checks and authentication.

## MALICIOUS CODE INDICATORS

This text describes different types of malicious code activities often observed in network attacks launched from compromised hosts. These activities include the execution of shellcode to gain access, credential dumping to steal login information, pivoting and lateral movement to spread within the network, and persistence techniques to maintain access even after a reboot. Each activity leaves specific indicators that can be detected by endpoint protection software or discovered through log analysis. Understanding these activities and their indicators is crucial in identifying and responding to network attacks.

**Breaking Down Concepts and Terms**:

- **Shellcode:** A small piece of code used to exploit a vulnerability and gain unauthorized access to a system.
- **Credential Dumping:** The process of stealing stored or cached login credentials from a system.
- **DCSync Attack:** An attack that tricks a domain controller into replicating user credentials to a rogue system.
- **Pivoting/Lateral Movement:** The act of moving from an initial compromised system to other systems within a network.
- **Persistence:** Techniques used by attackers to maintain access to a system even after a reboot or user logoff.
- **AutoRun Keys:** Registry entries that automatically execute programs when a system starts or a user logs in.
- **Scheduled Tasks:** Tasks configured to run automatically at specific times or intervals.
- **WMI Event Subscriptions:** Events that trigger specific actions when certain conditions are met.
- **Endpoint Protection Software:** Security software installed on individual devices to detect and prevent malicious activity.
- **Log Analysis:** The process of examining system logs to identify signs of malicious activity or unauthorized access.

## APPLICATION ATTACKS

This text discusses how application attacks exploit vulnerabilities in software to gain unauthorized access or cause system crashes. It covers two main scenarios: attacks on network hosts and attacks on web applications. The text also describes how privilege escalation can occur after a successful attack, and how buffer overflows can be exploited to execute arbitrary code.

Breaking down concepts and terms:

- **Application Attack:** Exploits a vulnerability in OS or application software.
- **Application Vulnerability:** Design flaw that allows for attacks or crashes.
- **Arbitrary Code Execution:** Ability for an attacker to run their own code on a compromised system.
- **Remote Code Execution:** Arbitrary code execution where the code is transmitted from another machine.
- **Privilege Escalation:** Gaining higher level privileges than the exploited process.
- **Vertical Privilege Escalation:** Gaining higher privileges within the same context (e.g., user to administrator).
- **Horizontal Privilege Escalation:** Gaining access to functionality or data intended for another user.
- **Buffer Overflow:** Occurs when data written to a buffer exceeds its capacity, overwriting adjacent memory.
- **Stack Overflow:** A type of buffer overflow targeting the program's call stack.
- **Address Space Layout Randomization (ASLR):** A security technique that randomizes memory addresses to make exploitation more difficult.
- **Data Execution Prevention (DEP):** A security feature that prevents code execution from non-executable memory regions.

## REPLAY ATTACKS

This section explains how replay attacks exploit web applications, primarily by targeting cookie-based session management. It outlines how session tokens, often stored in cookies, can be captured or guessed by attackers to hijack legitimate user sessions. The text emphasizes the importance of generating unpredictable session tokens and using proper session management practices to mitigate such attacks.

![](../../../Attachments/Pasted%20image%2020240818194325.png)

Breaking down concepts and terms:

- **Replay Attack:** In the context of web applications, it refers to an attacker capturing a valid session token and reusing it to impersonate the legitimate user.
- **HTTP Statelessness:** HTTP's inherent characteristic of not retaining information about past client requests, necessitating the use of cookies for stateful data.
- **Cookies:** Small pieces of data stored on the client-side, used by web applications to track user sessions and store preferences.
- **Session Management:** The mechanism that enables a web application to recognize and maintain a user's unique identity across different interactions.
- **Session Token:** A unique identifier used to represent a user's session within a web application.
- **On-Path Attack:** A type of attack where the attacker intercepts and manipulates communication between two parties.
- **Cross-Site Scripting (XSS):** A vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users.  
- **Session Prediction Attack:** An attempt to predict future session token values based on weaknesses in the token generation algorithm.

## FORGERY ATTACKS

This text describes two types of attacks targeting web applications: cross-site request forgery (CSRF) and server-side request forgery (SSRF). CSRF tricks a victim's browser into making unauthorized requests on a trusted website, while SSRF manipulates a server to make unintended requests to other services, potentially exposing internal systems or data. Both attacks highlight the importance of proper input validation and security mechanisms to protect against unauthorized actions and data breaches.

![](../../../Attachments/Pasted%20image%2020240818194615.png)
-- 
![](../../../Attachments/Pasted%20image%2020240818194654.png)

Breaking down concepts and terms:

- **Forgery Attack:** A type of attack that manipulates requests or data to perform unauthorized actions without the user's consent.
- **Cross-Site Request Forgery (CSRF):** A vulnerability that tricks a user's browser into executing actions on a trusted website without their knowledge.
- **Confused Deputy Attack:** A type of CSRF where the server trusts the user's browser, even though the request was initiated by an attacker.
- **Server-Side Request Forgery (SSRF):** An attack that forces a server to make requests to other services, potentially exposing internal systems or data.
- **Input Validation:** The process of ensuring that user input conforms to expected formats and values to prevent security vulnerabilities

## INJECTION ATTACKS

This text describes server-side attacks, particularly injection attacks, that exploit insecure application request and query handling. It covers how injection attacks can lead to unauthorized data access or modifications. Specific examples discussed include XML External Entity (XXE) attacks that expose local files and LDAP injection attacks that manipulate directory databases. These attacks highlight the importance of proper input validation and sanitization to protect against server-side vulnerabilities.

Breaking down concepts and terms:

- **Server-Side Attack:** An attack that targets vulnerabilities in the server's processing or execution of code, often leading to data breaches or system compromise.
- **Injection Attack:** A broad category of attacks that exploit vulnerabilities in how applications handle user input, often by injecting malicious code or commands.
- **XML External Entity (XXE) Attack:** An attack that exploits vulnerabilities in XML parsing to access or expose sensitive data on the server.
- **Lightweight Directory Access Protocol (LDAP):** A protocol used to access and manage directory services, such as user accounts and authentication information.
- **LDAP Injection Attack:** An attack that exploits vulnerabilities in LDAP query handling, potentially allowing unauthorized access or modification of directory data.
- **Input Validation and Sanitization:** Security practices that ensure user input is properly checked and cleaned before being processed by an application.

## DIRECTORY TRAVERSAL AND COMMAND INJECTION ATTACKS

This text describes injection attacks that target web servers, focusing on directory traversal and command injection. It highlights how attackers exploit vulnerabilities in input validation and canonicalization processes to access unauthorized files or execute commands on the server. These attacks underscore the importance of secure coding practices and robust input validation to protect web applications from malicious actions.

**Breaking Down Concepts and Terms**

- **Directory Traversal:** An attack that aims to access files and directories outside the web server's root directory by manipulating file paths.
- **Canonicalization Attack:** An attack that exploits inconsistencies in how a server processes different representations of a resource, often used to bypass security measures.
- **Command Injection Attack:** An attack that injects and executes arbitrary commands on the server, potentially leading to unauthorized access or control.
- **Input Validation:** The process of checking user input to ensure it conforms to expected formats and values, preventing malicious input from being processed.
- **Sanitization:**- The process of cleaning or modifying user input to remove potentially harmful characters or code.

## URL ANALYSIS

This text focuses on identifying and understanding session hijacking, forgery, and injection attacks. It explains how Uniform Resource Locator (URL) analysis and web server logs are essential tools for detecting these threats. It describes HTTP operations, the structure of URLs, and the use of percent encoding, highlighting how these can be exploited by attackers.

Breaking down concepts and terms:

- **URL Analysis:** Examining URLs to identify suspicious patterns or malicious intent.
- **Web Server Access Log:** A record of client requests to a web server, including details like IP addresses, timestamps, requested resources, and response codes.
- **HTTP:** The protocol used for communication between web browsers and servers.
- **HTTP Methods:** Verbs like GET, POST, and PUT that define the action to be performed on a resource.
- **URL Structure:** Components of a URL, including protocol, domain, path, query parameters, and fragment identifier.
- **Percent Encoding:** A method of encoding special or unsafe characters within a URL.
- **Reserved Characters:** Characters with specific meanings in URL syntax, requiring encoding if used for other purposes.
- **Unsafe Characters:** Characters that should not be used in a URL, often encoded for security reasons.

## WEB SERVER LOGS

This text discusses how web servers use logs to record error events and specific types of traffic, which can be helpful in identifying potential attacks like session replay, forgery, and injection attacks. Status codes within the logs provide information about client errors and server errors, while HTTP header information can reveal details about each request and response, including potentially sensitive cookie data. Analyzing these logs can help detect suspicious activity and identify vulnerabilities.

**Breaking down concepts and terms**

- Web server logs: Records of HTTP traffic that encountered errors or matched predefined rules, valuable for identifying attacks.
- Status codes: Numerical codes in HTTP responses indicating success, client errors, server errors, etc., aiding in understanding server behavior.
- HTTP header information: Additional details included in requests and responses, potentially revealing sensitive information like cookies.
- Session replay attacks: Reusing captured session data to gain unauthorized access.
- Forgery attacks: Manipulating requests to perform unauthorized actions.
- Injection attacks: Introducing malicious code into a system.


